{"version":3,"sources":["../src/drilldown.js"],"names":["finraDrilldownDirective","$compile","controller","DrilldownController","controllerAs","scope","title","series","seriesx","seriesy","label","drilldownConfig","datasource","endpoint","templateUrl","link","elem","attrs","ctrl","container","find","table","$","header","panelHeader","footer","currentlyViewing","updateTableHeight","css","height","resizable","handles","resize","event","ui","left","top","classes","maxWidth","width","minHeight","maxHeight","disableIf","logic","buildPaginationButton","labelText","goToPage","appendPaginationControls","pageCount","Math","ceil","items","rowsPerPage","pages","footerElem","empty","lowerBound","pageIndex","upperBound","rows","length","expectedItems","receivedItems","error","VM","dashAlerts","list","push","startPage","max","endPage","min","paginationList","append","i","activeClass","disabled","pageLinkElem","$watch","newVal","oldVal","html","$scope","datasourceSrv","opened","sort","loading","getData","organizationContact","page","undefined","targets","field","value","sorting","columnTitle","get","then","dataservice","getOrganization","response","address","address1","name","query","alias","resp","clearAlerts","data","col","columns","desc","slice","colIndex"],"mappings":"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","file":"drilldown.js","sourcesContent":["export function finraDrilldownDirective($compile) {\n     return {\n            controller: DrilldownController,\n            controllerAs: 'ddCtrl',\n            scope: {\n                title: \"@\",\n                series: '@',\n                seriesx: '@',\n                seriesy: '@',\n                label: \"@\",\n                drilldownConfig: \"=\",\n                datasource: \"=\",\n                endpoint: \"@\"\n            },\n            templateUrl: './partials/drilldown.html',\n            link: function (scope, elem, attrs, ctrl) {\n                let container = elem.find(\"#drilldownPanelContainer\");\n                let table = $('#drilldownTable');\n                let header = $('#drilldownTableHeader');\n                let panelHeader = $('#drilldownPanelHeader');\n                let footer = $('#drilldownTableFooter');\n                let currentlyViewing = $('#drilldownCurrentlyViewing');\n\n                let title = attrs.title;\n                let label = attrs.label;\n                let series = attrs.series;\n                let seriesx = attrs.seriesx;\n                let seriesy = attrs.seriesy;\n                let drilldownConfig = attrs.drilldownConfig;\n                let datasource = attrs.datasource;\n                let endpoint = attrs.endpoint;\n\n                let updateTableHeight = () => {\n                    table.css({height: container.height() - panelHeader.height() - header.height() - footer.height() - currentlyViewing.height()})\n                };\n\n                updateTableHeight();\n\n                container.resizable({\n                    handles: \"n\",\n                    resize: function (event, ui) {\n                        $(this).css({left: 0, top: ''});\n                        updateTableHeight();\n                    },\n                    classes: {\n                        \"ui-resizable-n\": \"drilldown-n\",\n                    },\n                    maxWidth: container.width(),\n                    minHeight: 250,\n                    maxHeight: 1000 //straighten out this logic.\n                });\n\n                let disableIf = (logic) => {\n                    return \"ng-disabled=\" + logic\n                };\n\n                let buildPaginationButton = (logic, labelText, goToPage) => {\n                    return $('<li><a ng-click=\"ddCtrl.getData(' + goToPage + ')\" class=\"table-panel-page-link pointer\"' + disableIf(logic) + '> ' + labelText + ' </a></li>')\n                };\n\n                let appendPaginationControls = (pageCount) => {\n\n                    // Calculate number of pages\n                    pageCount = Math.ceil(ctrl.table.items / scope.drilldownConfig.rowsPerPage);\n                    if(pageCount === 0)\n                        pageCount = 1;\n\n                    ctrl.table.pages = pageCount;\n                    \n                    let footerElem = elem.find('.table-panel-footer');\n                    footerElem.empty();\n                    scope.lowerBound = ctrl.pageIndex * scope.drilldownConfig.rowsPerPage + 1;\n                    scope.upperBound = ctrl.pageIndex + 1 === ctrl.table.pages ? scope.lowerBound + ctrl.table.rows.length - 1 : scope.lowerBound + scope.drilldownConfig.rowsPerPage - 1;\n\n                    let expectedItems = (ctrl.pageIndex + 1) * scope.drilldownConfig.rowsPerPage;\n                    let receivedItems = scope.lowerBound + ctrl.table.rows.length - 1;\n                    if (ctrl.pageIndex + 1 !== ctrl.table.pages  && receivedItems !== expectedItems)\n                    {\n                        let error = \"Expecting \" + scope.drilldownConfig.rowsPerPage + \" rows per page but received \" + ctrl.table.rows.length + \" rows\";\n                        VM.dashAlerts.list.push({\"text\": error});\n                    }\n\n                    if(ctrl.pageIndex + 1 === ctrl.table.pages && ctrl.pageIndex != 0 && receivedItems != ctrl.table.items) {\n                        let error = \"Last Page expecting \" + (ctrl.table.items - (scope.lowerBound - 1) ) + \" rows but received \" + ctrl.table.items + \" rows\";\n                        VM.dashAlerts.list.push({\"text\": error});\n                    }\n\n                    if(ctrl.pageIndex + 1 === ctrl.table.pages && ctrl.pageIndex == 0 && receivedItems != ctrl.table.items) {\n                        let error = \"Expecting \" + ctrl.table.items + \" total items but received \" + ctrl.table.rows.length + \" items\";\n                        VM.dashAlerts.list.push({\"text\": error});\n                    }\n\n                    if (pageCount === 1) {\n                        return;\n                    }\n\n                    let startPage = Math.max(ctrl.pageIndex - 3, 0);\n                    let endPage =  Math.min(pageCount, startPage + 9);\n                    let paginationList = $('<ul></ul>');\n\n                    //appending the go to first + the go back 10 pages handles\n                    paginationList.append(buildPaginationButton(ctrl.pageIndex === 0, '<<', 0));\n                    paginationList.append(buildPaginationButton(ctrl.pageIndex === 0, '<', ctrl.pageIndex - 1));\n\n                    for (let i = startPage; i < endPage; i++) {\n                        let activeClass = i === ctrl.pageIndex ? 'active' : '';\n                        let disabled = i === ctrl.pageIndex ? 'ng-disabled=\"true\"' : '';\n                        let pageLinkElem = $('<li><a ng-click=\"ddCtrl.getData(' + i + ')\" class=\"table-panel-page-link pointer ' + activeClass + '\" ' + disabled + '>' + (i + 1) + '</a></li>');\n                        paginationList.append(pageLinkElem);\n                    }\n\n                    //appending the skip 10 + the go to last page handles\n                    if(ctrl.pageIndex < pageCount)\n                        paginationList.append(buildPaginationButton(ctrl.pageIndex === pageCount - 1, '>', ctrl.pageIndex + 1));\n                    else\n                        paginationList.append(buildPaginationButton(ctrl.pageIndex === pageCount - 1, '>', pageCount -1));\n\n                    paginationList.append(buildPaginationButton(ctrl.pageIndex === pageCount - 1, '>>', pageCount - 1));\n\n                    footerElem.append(paginationList);\n\n                    $compile(footerElem)(scope);\n                    updateTableHeight();\n                };\n\n                //Re-generate the values everytime something about the table changes (generally a user clicking a new page)\n                scope.$watch(\"table\", () => {\n                    if (ctrl.table) {\n                        appendPaginationControls(ctrl.table.pages);\n                    }\n                });\n\n                scope.$watch(\"opened\", (newVal, oldVal) => {\n                    if (!newVal) {\n                        elem.html(\"\");\n                    }\n                });\n\n            }\n        }\n}\n\nlet VM;\nclass DrilldownController {\n    constructor($scope, datasourceSrv){\n\n        VM = this;\n        VM.$scope = $scope;\n\n        $scope.opened = true;\n        this.pageIndex = 0;\n        this.datasourceSrv = datasourceSrv;\n        this.sort = {};\n        this.loading=false;\n        this.getData(0);\n        this.dashAlerts = {};\n        this.dashAlerts.list = [];\n        this.organizationContact = \"API admin\";\n    }\n\n    getData(page){\n\n        if(VM.$scope.drilldownConfig.rowsPerPage === undefined)\n            VM.$scope.drilldownConfig.rowsPerPage = 10;\n\n        VM.loading=true;\n        VM.targets = {};\n        VM.targets = [{\n            field: \"page\",\n            value: page + 1\n        }, {\n            field: \"rowsPerPage\",\n            value: VM.$scope.drilldownConfig.rowsPerPage\n        }, {\n            field: \"selected\",\n            value: VM.$scope.label\n        }];\n\n        if(VM.$scope.series != \"null\")\n            VM.targets.push({\n                field: \"series\",\n                value: VM.$scope.series\n            });\n\n        if(VM.$scope.seriesx != undefined)\n            VM.targets.push({\n                field: \"seriesX\",\n                value: VM.$scope.seriesx\n            });\n\n        if(VM.$scope.seriesy != undefined)\n            VM.targets.push({\n                field: \"seriesY\",\n                value: VM.$scope.seriesy\n            });\n\n        if(VM.$scope.sorting)\n            VM.targets.push({\n                field: \"sorting\",\n                value: VM.$scope.sorting\n             });\n\n        if(VM.$scope.columnTitle)\n            VM.targets.push({\n                field: \"columnTitle\",\n                value: VM.$scope.columnTitle\n            });\n\n        this.datasourceSrv.get().then(function(dataservice){\n            dataservice.getOrganization().then((response) => {\n                if (response !== undefined && response !== null && response.address !== null)\n                    VM.organizationContact = response.address.address1;\n            }, (error) => {\n                    VM.organizationContact = response.name + \" API admin\";\n            });\n\n            dataservice.query({\n                alias: VM.$scope.endpoint,\n                targets: VM.targets\n            }).then((resp) => {\n                VM.clearAlerts();\n                VM.table = resp.data;\n                VM.$scope.table = VM.table;\n                VM.pageIndex = page;\n                if (VM.sort.col) {\n                    VM.table.columns[VM.sort.col].sort = true;\n                    VM.table.columns[VM.sort.col].desc = VM.sort.desc\n                }\n\n                if (resp.data.items < 1) {\n                    let error = \"DrillDown numberOfItems is less than 1\";\n                    VM.dashAlerts.list.push({\"text\": error});\n                }\n\n                // Truncate extra rows if more rows returned than rowsPerPage\n                if (resp.data.rows && VM.$scope.drilldownConfig.rowsPerPage < resp.data.rows.length) {\n                    let error = \"Expecting \" + VM.$scope.drilldownConfig.rowsPerPage + \" rows per page but received \" + resp.data.rows.length + \" rows\";\n                    VM.dashAlerts.list.push({\"text\": error});\n                    resp.data.rows = resp.data.rows.slice(0, VM.$scope.drilldownConfig.rowsPerPage);\n                }\n\n                VM.loading=false;\n            });\n        });\n    }\n\n    getSortingFlag(col) {\n        return col.sort;\n    }\n\n    toggleColumnSort(col, colIndex){\n        // remove sort flag from current column\n        if (VM.table.columns[VM.sort.col]) {\n            VM.table.columns[VM.sort.col].sort = false;\n            col.sort = false;\n        }\n\n        if (VM.sort.col === colIndex) {\n            if (VM.sort.desc) {\n                VM.sort.desc = false;\n                col.desc = false;\n                col.sort = true;\n            } else {\n                VM.sort.col = null;\n                VM.sort.desc = null;\n            }\n        } else {\n            VM.sort.col = colIndex;\n            VM.sort.desc = true;\n            col.sort = true;\n            col.desc = true;\n        }\n\n        VM.$scope.sorting = \"none\";\n        if(col.sort) {\n            if(col.desc) {\n                VM.$scope.sorting = \"descending\";\n            } else {\n                VM.$scope.sorting = \"ascending\";\n            }\n        }\n\n        VM.$scope.columnTitle = col.title;\n\n        this.getData(VM.pageIndex);\n    }\n\n    exitDrillDown(){\n        VM.$scope.opened = false;\n    }\n\n    clearAlerts(){\n        VM.dashAlerts.list = [];\n    }\n}"]}