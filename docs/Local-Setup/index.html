



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
        <link rel="canonical" href="https://finraos.github.io/aphelion/Local-Setup/">
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../">
      <meta name="generator" content="mkdocs-0.17.3, mkdocs-material-2.5.4">
    
    
      
        <title>Local Setup - Aphelion</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-palette.css">
      
    
    
      <script src="../assets/javascripts/modernizr.js"></script>
    
    
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
    
  </head>
  
  
    
    
    <body dir="ltr" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <a href="#local-setup" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header style="background-color: #3856A9" class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a style="padding:4px 8px;" target="_parent" href="https://finraos.github.io/aphelion" title="Aphelion" class="md-header-nav__button md-logo">
          
            <img src="../images/logo.svg" width="32" height="32">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                Aphelion
              </span>
              <span class="md-header-nav__topic">
                Local Setup
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <span class="md-nav__button md-logo">
      
        <img src="../images/logo.svg" width="24" height="24">
      
    </span>
    Aphelion
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../AWS-Setup/" title="AWS IAM Role Setup" class="md-nav__link">
      AWS IAM Role Setup
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        Local Setup
      </label>
    
    <a href="./" title="Local Setup" class="md-nav__link md-nav__link--active">
      Local Setup
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Contents </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#prerequisites" title="Prerequisites" class="md-nav__link">
    Prerequisites
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configure" title="Configure" class="md-nav__link">
    Configure
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#environment-variables" title="Environment Variables" class="md-nav__link">
    Environment Variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#docker-compose-example" title="Docker Compose Example" class="md-nav__link">
    Docker Compose Example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#run" title="RUN" class="md-nav__link">
    RUN
  </a>
  
</li>
      
      
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../Deploy/" title="Deploy" class="md-nav__link">
      Deploy
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../Troubleshooting/" title="Troubleshooting" class="md-nav__link">
      Troubleshooting
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Contents </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#prerequisites" title="Prerequisites" class="md-nav__link">
    Prerequisites
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configure" title="Configure" class="md-nav__link">
    Configure
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#environment-variables" title="Environment Variables" class="md-nav__link">
    Environment Variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#docker-compose-example" title="Docker Compose Example" class="md-nav__link">
    Docker Compose Example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#run" title="RUN" class="md-nav__link">
    RUN
  </a>
  
</li>
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="local-setup">Local Setup<a class="headerlink" href="#local-setup" title="Permanent link">&para;</a></h1>
<h2 id="prerequisites">Prerequisites<a class="headerlink" href="#prerequisites" title="Permanent link">&para;</a></h2>
<p>Must be able to run application with a role that is able to assume <code>ASSUMED_ROLE_NAME</code>
with proper permissions to create report.</p>
<p>Since trusted advisor must be told to refresh its values, the script
limits-refresh.py must be run some time in advance of the limits collection.
Generally, 1 hour before hand is a safe value, but your mileage may vary.</p>
<p>Aphelion expect to find AWS credentials through the normal client/SDK
discovery mechanisms (instance profile, .aws/credentials file, ENV variables, 
etc), and the principal linked to those credentials must be able to assume a
role in each target account. Those target role names must be identical in each
target account. That target role must have permissions necessary to list or
describe the resources that are being inspected, as well as issue a TA refresh
and get a TA report.</p>
<h2 id="configure">Configure<a class="headerlink" href="#configure" title="Permanent link">&para;</a></h2>
<p>Aphelion requires the following properties to be set in order to run.</p>
<h3 id="environment-variables">Environment Variables<a class="headerlink" href="#environment-variables" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr>
<td>ASSUMED_ROLE_NAME</td>
<td>The name of the role to assume to inspect an account. This needs to be the same across all target accounts</td>
<td>assumed_role_name</td>
</tr>
<tr>
<td>ASSUMED_ROLE_SESSION_NAME</td>
<td>Role session name to pass when assuming the role</td>
<td>limit_dashboard</td>
</tr>
<tr>
<td>ACCOUNT_ID_LIST</td>
<td>Comma separated list of account IDs to interrogate. Will accept with or without leading and/or trailing spaces</td>
<td>1234567891011, 1234567891012, 1234567891013, 1234567891014</td>
</tr>
<tr>
<td>REGIONS</td>
<td>Regions of interest. TA limits not in this list will be dropped, and non TA limit checks will only be performed in the regions listed</td>
<td>us-east-1, us-east-2</td>
</tr>
<tr>
<td>REPORT_FILE_NAME</td>
<td>Name of the CSV file to create with the results</td>
<td>limits.csv</td>
</tr>
<tr>
<td>CRON_REFRESH</td>
<td>Cron schedule to run limits-refresh.  Must run about an hour before CRON_LIMITS</td>
<td>0 2 * * *</td>
</tr>
<tr>
<td>CRON_LIMITS</td>
<td>Cron schedule to run limits report.</td>
<td>0 3 * * *</td>
</tr>
<tr>
<td>AWS_DEFAULT_REGION</td>
<td>AWS Default Region</td>
<td>us-east-1</td>
</tr>
</tbody>
</table>
<h3 id="docker-compose-example">Docker Compose Example<a class="headerlink" href="#docker-compose-example" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">version</span><span class="p p-Indicator">:</span> <span class="s">&#39;2&#39;</span>
<span class="l l-Scalar l-Scalar-Plain">services</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">aphelion-service</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">image</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">finraos/aphelion-service:latest</span>
    <span class="l l-Scalar l-Scalar-Plain">environment</span><span class="p p-Indicator">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ASSUMED_ROLE_NAME=assumed_role_name</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ACCOUNT_ID_LIST=123456789101, 123456789102, 123456789103</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ASSUMED_ROLE_SESSION_NAME=limit_dashboard</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">REGIONS=us-east-1, us-east-2, us-west-1</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">REPORT_FILE_NAME=limits.csv</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">CRON_REFRESH=* * * * *</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">CRON_LIMITS=* * * * *</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">AWS_DEFAULT_REGION=us-east-1</span>
    <span class="l l-Scalar l-Scalar-Plain">volumes</span><span class="p p-Indicator">:</span>
       <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">/Users/$USER/.aws:/root/.aws</span>
  <span class="l l-Scalar l-Scalar-Plain">dashboard-service</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">image</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">finraos/aphelion-dashboard-service</span>
  <span class="l l-Scalar l-Scalar-Plain">web</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">image</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">finraos/aphelion-web</span>
    <span class="l l-Scalar l-Scalar-Plain">ports</span><span class="p p-Indicator">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">443:8443</span>
    <span class="l l-Scalar l-Scalar-Plain">restart</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">always</span>
    <span class="l l-Scalar l-Scalar-Plain">links</span><span class="p p-Indicator">:</span>
     <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">dashboard-service</span>
     <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">aphelion-service</span>
</pre></div>

<div class="admonition warning">
<p class="admonition-title">AWS Credentials</p>
<p>To run locally you might need to mount your ./AWS folder to aphelion-service
<div class="codehilite"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">volumes</span><span class="p p-Indicator">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">/Users/$USER/.aws:/root/.aws</span>
</pre></div></p>
</div>
<h2 id="run">RUN<a class="headerlink" href="#run" title="Permanent link">&para;</a></h2>
<ol>
<li>Start service
    <div class="codehilite"><pre><span></span>docker-compose -f local.yml up
</pre></div></li>
<li>Navigate to URL
    <div class="codehilite"><pre><span></span>https://localhost
</pre></div></li>
</ol>
                
                  
                
              
              
                
              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../AWS-Setup/" title="AWS IAM Role Setup" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                AWS IAM Role Setup
              </span>
            </div>
          </a>
        
        
          <a href="../Deploy/" title="Deploy" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Deploy
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.js"></script>
      
      <script>app.initialize({version:"0.17.3",url:{base:".."}})</script>
      
    
    
      
    
  </body>
</html>
